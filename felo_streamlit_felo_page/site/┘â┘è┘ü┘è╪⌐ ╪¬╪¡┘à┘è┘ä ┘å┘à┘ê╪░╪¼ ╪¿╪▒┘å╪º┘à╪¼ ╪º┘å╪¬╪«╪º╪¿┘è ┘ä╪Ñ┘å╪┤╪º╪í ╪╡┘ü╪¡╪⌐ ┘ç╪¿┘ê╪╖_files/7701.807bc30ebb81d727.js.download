"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7701],{87701:function(e,t,r){r.r(t);var a=r(52676),i=r(75271),s=r(26595),o=r(7717),n=r(57546),l=r(48958),d=r(26142),c=r(5311),u=r(67241),_=r(43378),m=r(81492),g=r(52448),f=r(36716),p=r(78423),v=r(31063),x=r(60161),w=r(77844),h=r(65819),b=r(25794);t.default=()=>{let e=(0,o.useTranslations)(),t=(0,n.Z)(e=>e.loginModalVisible),r=async()=>{n.Z.getState().setLoginModalVisible(!1),await new Promise(e=>setTimeout(e,300)),n.Z.getState().setIsEnterpriseLogin(!1),D(!1),L("setup"),q(null)},y=(0,n.Z)(e=>e.callbackUri),k=(0,n.Z)(e=>e.isEnterpriseLogin),N=h.ZP.getState().userInfo,[S,C]=(0,i.useState)(""),[E,j]=(0,i.useState)(""),[F,I]=(0,i.useState)(""),R=(0,i.useRef)(null),A=(0,i.useRef)(null);(0,f.Z)(e=>e.setBindingConfig);let[Z,D]=(0,i.useState)(!1),[B,L]=(0,i.useState)("setup"),[T,O]=(0,i.useState)(null),[U,q]=(0,i.useState)(null),[P,z]=(0,i.useState)(null);(0,i.useEffect)(()=>{t&&(C(""),j(""),X(),D(!1),L("setup"),q(null),O(null),z(null))},[t]);let{error:V,setError:G,loading:W,isRegisterMode:Y,showPasswordInput:M,validateEmail:$,register:Q,login:H,loginByGoogle:J,loginByApple:K,reset:X,loginType:ee,setLoginType:et,isSSOLoginError:er,setIsSSOLoginError:ea,showVerificationCode:ei,verificationCode:es,setVerificationCode:eo,countdown:en,canResend:el,resendVerificationCode:ed,verifyCode:ec}=(0,d.Z)({email:S,onSucceed:async e=>{if("TOTP_BINDING_REQUIRED"===e){D(!0),L("setup");return}if("TOTP_VERIFICATION_REQUIRED"===e){D(!0),L("verify");return}C(""),j(""),r()}}),eu=()=>{C(""),j(""),r()},e_=()=>{(0,p.bf)();let e=w.Z.getState().firstFrom;(0,v.fk)(x.U.LOGIN,{uid:(null==N?void 0:N.uid)||"",inviteCode:e})};(0,i.useEffect)(()=>{var e;M&&(null===(e=A.current)||void 0===e||e.focus())},[M]);let em=(0,i.useMemo)(()=>"sso"!==ee?e("enterprise.ssoLogin.title"):e("login.email_login_register"),[ee,e]),eg=(0,i.useMemo)(()=>ei&&!M?"verifyCode"===W?e("login.verifying"):e("login.verify_email"):M?"sso"===ee?e("enterprise.ssoLogin.use_sso_continue"):Y?e("login.register_and_verify_email"):e("login.email_login"):"sso"===ee?e("enterprise.ssoLogin.use_sso_continue"):e("login.use_email_login"),[M,ei,Y,ee,W,e]),ef=()=>{I(""),G(""),ea(!1),"sso"===ee?et("email"):et("sso")},ep=async t=>{var r,a;if(t.preventDefault(),S&&!W){if(I(""),G(""),ea(!1),!(null===(r=R.current)||void 0===r?void 0:r.validity.valid)){G("login.email_incorrect");return}if("sso"===ee){let t=await (0,m.ri)(S);if("USER_NOT_FOUND"===t.code){I(e("enterprise.ssoLogin.error_not_have"));return}t.data.is_sso?window.location.href="".concat("https://account.felo.ai","/api/sso/authorize?email=").concat(S):I(e("enterprise.ssoLogin.error_not_have"));return}if(ei&&!M){ec();return}if(!M){$();return}if(!(null===(a=A.current)||void 0===a?void 0:a.validity.valid)){G("login.password_incorrect");return}if(Y){Q({email:S,password:E,verifyCode:ei?es:void 0});return}H({email:S,password:E,callbackUri:y})}},ev=()=>{M&&$()};return(0,a.jsx)(_.Vq,{open:t,onOpenChange:r,children:(0,a.jsxs)(_.cZ,{hideCloseButton:"success"===B,className:"max-w-md py-3 !rounded-2xl",children:[(0,a.jsxs)(_.fK,{children:[(0,a.jsx)(_.$N,{className:"text-3xl mb-2 text-[#30394a] dark:text-white",children:(()=>{if(Z)switch(B){case"setup":case"help":case"verify":return e("security.twoFactorTitle");case"success":return e("security.twoFactorSuccess");default:return""}return Y?e("login.register_felo"):k?e("enterprise.welcome_to_felo_enterprise"):e("login.welcome_to_felo")})()}),!Z&&(0,a.jsx)(_.Be,{className:"text-lg text-[#30394a] dark:text-white",children:Z?"":Y?e("login.register_felo_desc"):k?e("enterprise.welcome_to_felo_enterprise_desc"):e("login.unlock_all_features")})]}),(0,a.jsx)(_.a7,{className:"w-full ".concat(Z?"pt-0":"pt-2"," max-w-md mx-auto text-[#30394a] dark:text-white"),children:Z?(0,a.jsx)(g.Z,{step:B,onStepChange:e=>{L(e)},onSuccess:e=>{(0,b.F_)(e),e_(),y&&(window.location.href=y),eu()}}):(0,a.jsx)(a.Fragment,{children:ei&&!M?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("form",{onSubmit:ep,noValidate:!0,children:[(0,a.jsx)(l.Y,{ref:R,className:"mb-4",classNames:{inputWrapper:"border-1 border-[#ACB9CD] dark:border-[#545D6F]"},type:"email",value:S,onChange:e=>{C(e.target.value.replace(/[^a-zA-Z0-9@._+%-]/g,""))},variant:"bordered",required:!0,pattern:"^[a-zA-Z0-9._%+\\-]+@[a-zA-Z0-9.\\-]+\\.[a-zA-Z]{2,}$",onBlur:ev,placeholder:e("login.enter_email"),disabled:ei}),(0,a.jsx)(l.Y,{className:"mb-4",classNames:{inputWrapper:"border-1 border-[#ACB9CD] dark:border-[#545D6F]"},type:"text",value:es,onChange:e=>{eo(e.target.value.replace(/[^0-9]/g,""))},variant:"bordered",required:!0,maxLength:6,placeholder:e("login.enter_verification_code_from_email"),endContent:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"h-4 self-center border-l border-divider mx-2"}),en>0?(0,a.jsx)("span",{className:"text-sm text-blue-500",children:en}):(0,a.jsx)("button",{type:"button",className:"text-sm min-w-10 w-fit text-[#0080FF] hover:text-blue-800 ".concat(el?"":"opacity-50 cursor-not-allowed"),disabled:!el||"sendCode"===W,onClick:ed,children:"sendCode"===W?e("login.sending"):e("login.resend_code")})]})}),V&&(0,a.jsx)("p",{className:"text-sm text-red-500 mb-4",children:e(V)}),(0,a.jsx)(s.A,{className:"w-full mb-4",type:"submit",variant:"solid",color:"primary",isLoading:"verifyCode"===W,isDisabled:!S||!es,children:eg}),F&&(0,a.jsx)("div",{className:"text-red-600 text-center mb-4 text-sm",children:F}),er&&(0,a.jsx)("p",{className:"text-red-600 text-center mb-4 text-s",children:e("enterprise.ssoLogin.error_have")}),!ei&&(0,a.jsx)("div",{className:"cursor-pointer text-[#4B5F7F] dark:text-[#9295A1] mb-4 text-center text-sm",onClick:ef,children:em})]}),(0,a.jsx)("div",{className:"text-center mb-4 text-sm",children:e("login.or")}),(0,a.jsxs)(s.A,{className:"w-full rounded-lg mb-4 border-1 border-[#ACB9CD] dark:border-[#545D6F] text-[#4B5F7F] dark:text-[#9295A1] font-bold",variant:"bordered",disabled:!!W,isLoading:"google"===W,onClick:()=>J(k?y||"/enterprise":location.href),children:[(0,a.jsx)(u._$,{className:"w-6 h-6"}),e("login.use_google_register")]}),(0,a.jsxs)(s.A,{className:"w-full rounded-lg border-1 border-[#ACB9CD] dark:border-[#545D6F] text-[#4B5F7F] dark:text-[#9295A1] font-bold",variant:"bordered",disabled:!!W,isLoading:"apple"===W,onClick:()=>K(k?y||"/enterprise":location.href),children:[(0,a.jsx)(u.nz,{className:"w-6 h-6"}),e("login.use_apple_register")]}),(0,a.jsxs)("div",{className:"cursor-pointer text-[#4B5F7F] dark:text-[#9295A1] mt-4 text-center text-sm flex justify-center items-center",children:[e("login.already_have_account"),(0,a.jsx)("span",{className:"text-blue-500 ml-1",onClick:()=>{I(""),G(""),ea(!1),X()},children:e("login.login")})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.A,{className:"w-full rounded-lg mb-4 border-1 border-[#ACB9CD] dark:border-[#545D6F] text-[#4B5F7F] dark:text-[#9295A1] font-bold",variant:"bordered",disabled:!!W,isLoading:"google"===W,onClick:()=>J(k?y||"/enterprise":location.href),children:[(0,a.jsx)(u._$,{className:"w-6 h-6"}),e("login.use_google_login")]}),(0,a.jsxs)(s.A,{className:"w-full rounded-lg mb-4 border-1 border-[#ACB9CD] dark:border-[#545D6F] text-[#4B5F7F] dark:text-[#9295A1] font-bold",variant:"bordered",disabled:!!W,isLoading:"apple"===W,onClick:()=>K(k?y||"/enterprise":location.href),children:[(0,a.jsx)(u.nz,{className:"w-6 h-6"}),e("login.use_apple_login")]}),(0,a.jsx)("div",{className:"text-center mb-4 text-sm",children:e("login.or")}),(0,a.jsxs)("form",{onSubmit:ep,noValidate:!0,children:[(0,a.jsx)(l.Y,{ref:R,className:"mb-4",classNames:{inputWrapper:"border-1 border-[#ACB9CD] dark:border-[#545D6F]"},type:"email",value:S,onChange:e=>{C(e.target.value.replace(/[^a-zA-Z0-9@._+%-]/g,""))},variant:"bordered",required:!0,pattern:"^[a-zA-Z0-9._%+\\-]+@[a-zA-Z0-9.\\-]+\\.[a-zA-Z]{2,}$",onBlur:ev,placeholder:e("login.enter_email"),disabled:ei}),M&&"sso"!==ee&&(0,a.jsx)(l.Y,{ref:A,className:"mb-4",type:"password",value:E,onChange:e=>j(e.target.value),variant:"bordered",required:!0,pattern:Y?"^(?=.*[a-zA-Z]).{8,}$":void 0,placeholder:e("login.enter_password"),disabled:ei}),V&&(0,a.jsx)("p",{className:"text-sm text-red-500 mb-4",children:e(V)}),M&&!Y&&"sso"!==ee&&(0,a.jsx)("p",{className:"text-sm opacity-60 text-right mb-4",children:(0,a.jsx)("a",{href:"".concat(c.I2,"/account/reset-password"),target:"_blank",onClick:e=>{e.preventDefault(),window.open("".concat(c.I2,"/account/reset-password?email=").concat(S))},children:e("login.forgot_password")})}),(0,a.jsx)(s.A,{className:"w-full mb-4",type:"submit",variant:"solid",color:"primary",isLoading:"email"===W||"validate"===W,isDisabled:!S||M&&Y&&!E||M&&!Y&&!E,children:eg}),F&&(0,a.jsx)("div",{className:"text-red-600 text-center mb-4 text-sm",children:F}),er&&(0,a.jsx)("p",{className:"text-red-600 text-center mb-4 text-s",children:e("enterprise.ssoLogin.error_have")}),!ei&&(0,a.jsx)("div",{className:"cursor-pointer text-[#4B5F7F] dark:text-[#9295A1] text-center text-sm",onClick:ef,children:em})]})]})})})]})})}},26142:function(e,t,r){var a=r(75271),i=r(81492),s=r(65819),o=r(25794),n=r(78423),l=r(71299),d=r(41847),c=r(31063),u=r(60161),_=r(77844),m=r(7717),g=r(17224),f=r(75979),p=r(39109),v=r(36716);t.Z=function(e){let{email:t,onSucceed:r}=e,[x,w]=(0,a.useState)(""),[h,b]=(0,a.useState)(""),[y,k]=(0,a.useState)(!1),[N,S]=(0,a.useState)(!1),[C,E]=(0,a.useState)("email"),[j,F]=(0,a.useState)(!1),I=(0,p.Z)(),R=(0,m.useTranslations)(),A=(0,g.useRouter)(),[Z,D]=(0,a.useState)(!1),[B,L]=(0,a.useState)(""),[T,O]=(0,a.useState)(0),[U,q]=(0,a.useState)(!1),[P,z]=(0,a.useState)("");(0,a.useEffect)(()=>{let e;return T>0?e=setTimeout(()=>{O(T-1)},1e3):0===T&&Z&&q(!0),()=>clearTimeout(e)},[T,Z]);let V=async e=>{let t=_.Z.getState().firstFrom,{anonymousToken:a}=s.ZP.getState(),d=null==e?void 0:e.callbackUri;return w("email"),(0,i.xJ)({...e,password:await (0,l.k)(e.password),app_id:"glaritySearch",client_type:"WEB",device_id:a,invitation_code:t}).then(e=>{var a,i;if(200!==e.status){b("server.".concat(e.code));return}if("IP_DISABLED"===e.data.error_code&&I.error(R("security.ipNotAuthorizedTip")),"TOTP_BINDING_REQUIRED"===e.data.error_code||"TOTP_VERIFICATION_REQUIRED"===e.data.error_code){v.Z.getState().setTempToken(e.data.token.token_value),r(e.data.error_code);return}if(r(),(0,o.F_)(e.data.token.token_value),(0,n.bf)(),(0,c.fk)(u.U.LOGIN,{uid:(null==e?void 0:null===(i=e.data)||void 0===i?void 0:null===(a=i.user)||void 0===a?void 0:a.uid)||"",inviteCode:t}),d){if(window.self!==window.top){let t=new URL(d);t.searchParams.set("third_auth_token",e.data.token.token_value),window.open(t.toString(),"_blank")}else window.location.href=d}else if(window.self!==window.top){window.parent.postMessage({type:"FELO_SEARCH_LOGIN",token:e.data.token.token_value},"*");let t=new URL(location.href);t.searchParams.set("third_auth_token",e.data.token.token_value),window.open(t.toString(),"_blank")}}).finally(()=>{w("")})},G=async()=>{if(t){w("sendCode"),b("");try{let e=await (0,i.O8)(t);200===e.status?(D(!0),S(!1),O(60),q(!1)):b("server.".concat(e.code))}catch(e){b(e.message)}finally{w("")}}},W=async e=>{if(!B){b(R("login.please_enter_verify_code"));return}if(6!==B.length||!/^\d{6}$/.test(B)){b(R("login.please_enter_6_digit_verify_code"));return}b(""),w("verifyCode");let{invite_code:r}=A.query,a=r||_.Z.getState().firstFrom,{anonymousToken:o}=s.ZP.getState();try{var n,m,g,p;let r=await (0,i.IU)({email:t,password:await (0,l.k)(P),app_id:"glaritySearch",device_id:o,client_type:"WEB",invitation_code:a,verify_code:B});200===r.status&&(null==r?void 0:null===(n=r.data)||void 0===n?void 0:n.uid)?(await V({email:t,password:P,callbackUri:e||void 0}),s.ZP.getState().setIsNewUser(!0),(0,f.f)("tw-q1qoc-q6142")):"EMAIL_VERIFY_CODE_ERROR"===r.code||"VERIFY_CODE_ERROR"===r.code?b(R("login.email_verify_code_error")):b("server.".concat(r.code)),(0,c.fk)(u.U.REGISTER,{uid:(null==r?void 0:null===(m=r.data)||void 0===m?void 0:m.uid)||"",inviteCode:a}),(0,d.I)({eventName:"user_register_success",eventParams:{event_category:"customEvent",event_label:"user_register_success",value:1}}),null===(g=(p=window).clarity)||void 0===g||g.call(p,"event","felo_search_register")}catch(e){b(e.message)}finally{w("")}};return{loading:x,register:async(e,t)=>{let{email:r,password:a,verifyCode:o}=e;if(!o){z(a),await G();return}w("email");let{invite_code:n}=A.query,m=n||_.Z.getState().firstFrom,{anonymousToken:g}=s.ZP.getState();return(0,i.IU)({email:r,password:await (0,l.k)(a),app_id:"glaritySearch",device_id:g,client_type:"WEB",invitation_code:m,verify_code:o}).then(e=>{var i,o,n,l;200===e.status&&(null==e?void 0:null===(i=e.data)||void 0===i?void 0:i.uid)?(V({email:r,password:a,callbackUri:t||void 0}),(0,f.f)("tw-q1qoc-q6142"),s.ZP.getState().setIsNewUser(!0)):"EMAIL_VERIFY_CODE_ERROR"===e.code||"VERIFY_CODE_ERROR"===e.code?b(R("login.email_verify_code_error")):b("server.".concat(e.code)),(0,c.fk)(u.U.REGISTER,{uid:(null==e?void 0:null===(o=e.data)||void 0===o?void 0:o.uid)||"",inviteCode:m}),(0,d.I)({eventName:"user_register_success",eventParams:{event_category:"customEvent",event_label:"user_register_success",value:1}}),null===(n=(l=window).clarity)||void 0===n||n.call(l,"event","felo_search_register")}).catch(e=>{b(e.message)}).finally(()=>{w("")})},login:V,loginByApple:e=>{w("apple");let{invite_code:t}=A.query,r=t||_.Z.getState().firstFrom;(0,i.Zf)({clientType:"WEB",appId:"glaritySearch",redirectUri:"".concat(window.location.origin,"/callback"),state:e?"redirect=".concat(e):void 0,invitationCode:r}).then(e=>{let{location:t}=e.data;t&&(window.self!==window.top?window.open(t,"_blank"):window.location.href=t)}).finally(()=>{w("")})},loginByGoogle:e=>{w("google");let{invite_code:t}=A.query,r=t||_.Z.getState().firstFrom;(0,i.u9)({clientType:"WEB",appId:"glaritySearch",redirectUri:"".concat(window.location.origin,"/callback"),state:e?"redirect=".concat(e):void 0,invitationCode:r}).then(e=>{let{location:t}=e.data;t&&(window.self!==window.top?window.open(t,"_blank"):window.location.href=t)}).finally(()=>{w("")})},validateEmail:()=>{t&&(b(""),w("validate"),(0,i.ri)(t).then(e=>{if("USER_NOT_FOUND"===e.code){k(!0),S(!0);return}if(e.data.is_sso){F(!0);return}k(!1),S(!0)}).catch(e=>{b(e.message)}).finally(()=>{w("")}))},isSSOLoginError:j,setIsSSOLoginError:F,reset:()=>{b(""),k(!1),S(!1),D(!1),L(""),O(0),q(!1),z("")},error:h,setError:b,isRegisterMode:y,showPasswordInput:N,loginType:C,setLoginType:E,showVerificationCode:Z,verificationCode:B,setVerificationCode:L,countdown:T,canResend:U,sendVerificationCode:G,resendVerificationCode:()=>{U&&G()},verifyCode:W}}},75979:function(e,t,r){r.d(t,{f:function(){return a}});let a=e=>{"function"==typeof window.twq&&window.twq("event",e,{status:"completed"})}}}]);